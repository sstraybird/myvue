{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isFunction(val) {\n    return typeof val === 'function';\n}\n\nexport function isObject(val) {\n    return typeof val == 'object' && val !== null\n\n}","import {isObject} from \"../utils\";\r\n\r\n// 检测数据变化 类有类型 ， 对象无类型\r\nclass Observer {\r\n    constructor(data) { // 对对象中的所有属性 进行劫持\r\n        this.walk(data); //对象劫持的逻辑\r\n    }\r\n    walk(data) { // 对象\r\n        Object.keys(data).forEach(key => {\r\n            defineReactive(data, key, data[key]);\r\n        })\r\n    }\r\n}\r\n\r\n// vue2 会对对象进行遍历 将每个属性 用defineProperty 重新定义 性能差\r\nfunction defineReactive(data,key,value){ // value有可能是对象\r\n    observe(value); // 本身用户默认值是对象套对象 需要递归处理 （性能差）\r\n    Object.defineProperty(data,key,{\r\n        get(){\r\n            return value\r\n        },\r\n        set(newV){\r\n            observe(newV); // 如果用户赋值一个新对象 ，需要将这个对象进行劫持\r\n            value = newV;\r\n        }\r\n    })\r\n}\r\n\r\nexport function observe(data) {\r\n    // 如果是对象才观测\r\n    if (!isObject(data)) {\r\n        return;\r\n    }\r\n    // 默认最外层的data必须是一个对象\r\n    console.log(\"observeData\",data)\r\n    // 默认最外层的data必须是一个对象\r\n    return new Observer(data)\r\n}","import {isFunction} from \"./utils\";\r\nimport { observe } from \"./observer/index\"; // node_resolve_plugin\r\n\r\nexport function initState(vm) { // 状态的初始化\r\n    const opts = vm.$options;\r\n    console.log(\"initSate\",opts)\r\n    if (opts.data) {\r\n        initData(vm);\r\n    }\r\n    // if(opts.computed){\r\n    //     initComputed();\r\n    // }\r\n    // if(opts.watch){\r\n    //     initWatch();\r\n    // }\r\n}\r\n\r\nfunction initData(vm) { //\r\n    let data = vm.$options.data; // vm.$el  vue 内部会对属性检测如果是以$开头 不会进行代理\r\n    // vue2中会将data中的所有数据 进行数据劫持 Object.defineProperty\r\n    // 这个时候 vm 和 data没有任何关系, 通过_data 进行关联\r\n    data = vm._data = isFunction(data) ? data.call(vm) : data;//data可能是函数或者对象\r\n    console.log(\"data\",data)\r\n\r\n    observe(data);\r\n}\r\n","//插件一般都是一个函数，需要调用一下才能用\r\n\r\nimport {initState} from \"./state\";\r\n\r\nexport function initMixin(Vue) {        //这里的Vue是VUe构造函数\r\n    Vue.prototype._init = function(options) {\r\n        console.log(options);\r\n        const vm = this     //this 都是指原型的实例 就是在index.html new出的vm   这里赋值给vm方便阅读 var that = this;\r\n        vm.$options = options    // 后面会对options进行扩展操作\r\n\r\n        // 对数据进行初始化 watch computed props data ...\r\n        initState(vm); // vm.$options.data  数据劫持\r\n    }\r\n}","import { initMixin } from \"./init\";\n\nfunction Vue(options) {     //构造函数模拟类，类中写prototype比较怪，用function符合习惯\n    // options 为用户传入的选项\n    this._init(options); // 创造一个实列进行初始化操作，核心操作， 组件也需要初始化，组件也应该有个_init方法,所以把_init变成公共方法，_表示私有，约定，\n                        //this 谁new 就是谁，实例上在initMixin上加了_init方法\n}\n\n//拆分，把不同的功能拆分到不同的文件中，通过注入的方式来使用\n// 扩展原型的，\ninitMixin(Vue);     //在原型上添加_init方法， 组件也需要初始化，组件也应该有个_init方法,所以把_init变成公共方法\n\nexport default Vue    //导出的会放到window下"],"names":["isFunction","val","isObject","Observer","data","walk","Object","keys","forEach","key","defineReactive","value","observe","defineProperty","get","set","newV","console","log","initState","vm","opts","$options","initData","_data","call","initMixin","Vue","prototype","_init","options"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAO,SAASA,UAAU,CAACC,GAAG,EAAE;IAC5B,OAAO,OAAOA,GAAG,KAAK,UAAU;EACpC;EAEO,SAASC,QAAQ,CAACD,GAAG,EAAE;IAC1B,OAAO,QAAOA,GAAG,KAAI,QAAQ,IAAIA,GAAG,KAAK,IAAI;EAEjD;;ECLA;EAAA,IACME,QAAQ;IACV,kBAAYC,IAAI,EAAE;MAAA;;MACd,IAAI,CAACC,IAAI,CAACD,IAAI,CAAC,CAAC;;IACnB;MAAA;MAAA,OACD,cAAKA,IAAI,EAAE;;QACPE,MAAM,CAACC,IAAI,CAACH,IAAI,CAAC,CAACI,OAAO,CAAC,UAAAC,GAAG,EAAI;UAC7BC,cAAc,CAACN,IAAI,EAAEK,GAAG,EAAEL,IAAI,CAACK,GAAG,CAAC,CAAC;SACvC,CAAC;;;IACL;EAAA;EAIL,SAASC,cAAc,CAACN,IAAI,EAACK,GAAG,EAACE,KAAK,EAAC;;IACnCC,OAAO,CAACD,KAAK,CAAC,CAAC;IACfL,MAAM,CAACO,cAAc,CAACT,IAAI,EAACK,GAAG,EAAC;MAC3BK,GAAG,iBAAE;QACD,OAAOH,KAAK;OACf;MACDI,GAAG,eAACC,IAAI,EAAC;QACLJ,OAAO,CAACI,IAAI,CAAC,CAAC;QACdL,KAAK,GAAGK,IAAI;;KAEnB,CAAC;EACN;EAEO,SAASJ,OAAO,CAACR,IAAI,EAAE;;IAE1B,IAAI,CAACF,QAAQ,CAACE,IAAI,CAAC,EAAE;MACjB;;;IAGJa,OAAO,CAACC,GAAG,CAAC,aAAa,EAACd,IAAI,CAAC;;IAE/B,OAAO,IAAID,QAAQ,CAACC,IAAI,CAAC;EAC7B;;EClCO,SAASe,SAAS,CAACC,EAAE,EAAE;;IAC1B,IAAMC,IAAI,GAAGD,EAAE,CAACE,QAAQ;IACxBL,OAAO,CAACC,GAAG,CAAC,UAAU,EAACG,IAAI,CAAC;IAC5B,IAAIA,IAAI,CAACjB,IAAI,EAAE;MACXmB,QAAQ,CAACH,EAAE,CAAC;;;;;;;;EAQpB;;EAEA,SAASG,QAAQ,CAACH,EAAE,EAAE;;IAClB,IAAIhB,IAAI,GAAGgB,EAAE,CAACE,QAAQ,CAAClB,IAAI,CAAC;;;IAG5BA,IAAI,GAAGgB,EAAE,CAACI,KAAK,GAAGxB,UAAU,CAACI,IAAI,CAAC,GAAGA,IAAI,CAACqB,IAAI,CAACL,EAAE,CAAC,GAAGhB,IAAI,CAAC;IAC1Da,OAAO,CAACC,GAAG,CAAC,MAAM,EAACd,IAAI,CAAC;IAExBQ,OAAO,CAACR,IAAI,CAAC;EACjB;;ECzBA;EAIO,SAASsB,SAAS,CAACC,GAAG,EAAE;;IAC3BA,GAAG,CAACC,SAAS,CAACC,KAAK,GAAG,UAASC,OAAO,EAAE;MACpCb,OAAO,CAACC,GAAG,CAACY,OAAO,CAAC;MACpB,IAAMV,EAAE,GAAG,IAAI;MACfA,EAAE,CAACE,QAAQ,GAAGQ,OAAO;;;MAGrBX,SAAS,CAACC,EAAE,CAAC,CAAC;KACjB;EACL;;ECXA,SAASO,GAAG,CAACG,OAAO,EAAE;;;IAElB,IAAI,CAACD,KAAK,CAACC,OAAO,CAAC,CAAC;;EAExB;;EAEA;EACA;EACAJ,SAAS,CAACC,GAAG,CAAC,CAAC;;;;;;;;;"}